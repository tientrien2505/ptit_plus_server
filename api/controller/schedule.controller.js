const cheerio = require('cheerio')
const request = require('request')

module.exports.index = (req, res1, next) =>{
    const msv = req.query.msv.toUpperCase();
    var jar = request.jar();
    request.get({
        url : 'http://qldt.ptit.edu.vn/',
        followAllRedirects : true, 
        jar : jar
    }, (err, res, body)=>{
        if (err){
            console.log(err);
            res1.end("loi");
            return;
        }
        let $ = cheerio.load(body);
        var capcha = $('span#ctl00_ContentPlaceHolder1_ctl00_lblCapcha').text();
        if (capcha!=null){
            request.post({
                url : 'http://qldt.ptit.edu.vn/default.aspx',
                form : {
                    __EVENTTARGET : '',
                    __EVENTARGUMENT : '',
                    __VIEWSTATE : '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',
                    __VIEWSTATEGENERATOR : 'CA0B0334',
                    ctl00$ContentPlaceHolder1$ctl00$txtCaptcha : 'RJO0A',
                    ctl00$ContentPlaceHolder1$ctl00$btnXacNhan : 'VÃ o website'
                },
                followAllRedirects : true,      
                jar : jar
            }, (err, res, body) =>{
                if (err){
                    console.log(err);
                    res1.end("loi");
                    return;
                }
                request.get({
                    url : 'http://qldt.ptit.edu.vn/default.aspx',
                    qs : {
                        page : 'thoikhoabieu',
                        id : msv,
                        sta : 1
                    },  
                    followAllRedirects : true,
                    jar : jar
                }, function (err, res, body) {
                    // body...
                    if (err){
                        console.log(err);
                        res1.end("loi");
                        return;
                    }
                    var arrKy = [];
                    $ = cheerio.load(body);
                    for (let i = 0; i < 3; i++){
                        arrKy.push($('select#ctl00_ContentPlaceHolder1_ctl00_ddlChonNHHK option').eq(i).val());
                    }
                    console.log(arrKy);
                    if (err){
                        console.log('loi');
                        return;
                    }
                    let rs = main(arrKy,msv);
                    // console.log("test");
                    // res1.json(JSON.stringify(rs));
                });
            });
        }else{
            request.get({
                url : 'http://qldt.ptit.edu.vn/default.aspx',
                qs : {
                    page : 'thoikhoabieu',
                    id : msv,
                    sta : 1
                },  
                followAllRedirects : true,
                jar : jar
            }, function (err, res, body) {
                if (err){
                    console.log(err);
                    res1.end("loi");
                    return;
                }
                var arrKy = [];
                $ = cheerio.load(body);
                for (let i = 0; i < 3; i++){
                    arrKy.push($('select#ctl00_ContentPlaceHolder1_ctl00_ddlChonNHHK option').eq(i).val());
                }
                console.log(arrKy);
                if (err){
                    console.log('loi');
                    return;
                }
                let rs = main(arrKy,msv);
            });
        }
    });

var main = async (arrKy,msv)=>{
    var jsonArr = [];
    for (let i = 0; i < 3; i++){
        await getTKB(arrKy[i],i,jsonArr,msv).then(res=>{console.log(res)}).catch(err=>{console.log(err)});
    }
    // console.log(JSON.stringify(jsonArr));
    console.log("test");
    res1.json(jsonArr);
}
var getTKB = async (k,i,jsonArr,msv)=>{
    return new Promise(async (resolve, reject)=>{
        let ky = k;
        let viewstate0 = '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ZGluZy1sZWZ0OjVweCc+VGjhu7FjIHThuq1wPC90ZD48dGQgd2lkdGg9ICcyOXB4JyBhbGlnbj0nY2VudGVyJyA+MDE8L3RkPjx0ZCB3aWR0aD0nMzVweCcgYWxpZ249J2NlbnRlcic+NDwvdGQ+PHRkIHdpZHRoPSc5MHB4JyBhbGlnbj0nY2VudGVyJz48L3RkPg0KPHRkIHdpZHRoPSczNnB4JyBhbGlnbj0nY2VudGVyJz40PC90ZD48dGQgd2lkdGg9JzM1cHgnIGFsaWduPSdjZW50ZXInPiA8L3RkPjx0ZCB3aWR0aD0nMzVweCcgYWxpZ249J2NlbnRlcic+DQogICA8L3RkPjx0ZCB3aWR0aD0nNDBweCcgYWxpZ249J2NlbnRlcic+PC90ZD48dGQgd2lkdGg9JzQwcHgnIGFsaWduPSdjZW50ZXInPjwvdGQ+PHRkIHdpZHRoPSc0MHB4JyBhbGlnbj0nY2VudGVyJz48L3RkPjx0ZCB3aWR0aD0nODBweCcgYWxpZ249J2NlbnRlcic+PC90ZD48dGQgd2lkdGg9JzU2cHgnIGFsaWduPSdjZW50ZXInPjwvdGQ+PHRkIGFsaWduPSdsZWZ0JyBzdHlsZT0nZm9udC1mYW1pbHk6Y291cmllcjtmb250LXNpemU6OHB0Jz48L3RkPjx0ZCAgd2lkdGg9JzQwcHgnIGFsaWduID0nY2VudGVyJz48L3RkPjwvdHI+PC90YWJsZT5kAhIPFgIfAAXQAkdoaSBjaMO6OiDEkEs6IMSRxINuZyBrw707IE3DoyBNSDogbcOjIG3DtG4gaOG7jWM7IE5NSDogTmjDs20gbcO0biBo4buNYzsgVFRIOiBU4buVIHRo4buxYyBow6BuaDsgU1RDOiBT4buRIHTDrW4gY2jhu4k7IFNUQ0hQOiBT4buRIHTDrW4gY2jhu4kgaOG7jWMgcGjDrTsgQ0w6IEPDsm4gbOG6oWk7IFRIOiBUaOG7sWMgaMOgbmgsIEtESzogS2jDtG5nIGNobyBwaMOpcCDEkcSDbmcga8O9O1Rp4bq/dCBCRDogVGnhur90IGLhuq90IMSR4bqndTsgU1QgOiBT4buRIFRp4bq/dDsgQ0JHRDogTcOjIGPDoW4gYuG7mSBnaeG6o25nIGThuqF5OyBEU1NWOiBEYW5oIHPDoWNoIHNpbmggdmnDqm47IGQCFA8PFgIfA2hkFg4CAQ9kFgJmD2QWDgIBD2QWAmYPDxYCHwAFCVRI4buoIEhBSWRkAgIPZBYCZg8PFgIfAAUIVEjhu6ggQkFkZAIDD2QWAmYPDxYCHwAFCVRI4buoIFTGr2RkAgQPZBYCZg8PFgIfAAUKVEjhu6ggTsSCTWRkAgUPZBYCZg8PFgIfAAUKVEjhu6ggU8OBVWRkAgYPZBYCZg8PFgIfAAULVEjhu6ggQuG6ollkZAIHD2QWAmYPDxYCHwAFDENI4bumIE5I4bqsVGRkAgMPDxYCHwAFKU3DtG4gaOG7jWMgY2jhu4kgdHLDuW5nIG3hu5l0IHbDoGkgdGnhur90ZGQCBQ8PFgIfAAUNVHXhuqduIMSQ4bqndWRkAgcPDxYCHwAFD1R14bqnbiBUcsaw4bubY2RkAgkPDxYCHwAFC1R14bqnbiBL4bq/ZGQCCw8PFgIfAAUNVHXhuqduIEN14buRaWRkAg0PDxYCHwAFNg0KICAgICAgTcO0biBo4buNYyB0csO5bmcgdOG6pXQgY+G6oyBjw6FjIHRp4bq/dA0KICAgIGRkAgkPZBYIAgEPDxYCHwAFOUNvcHlyaWdodCDCqTIwMDkgQ8ahIFPhu58gTWnhu4FuIELhuq9jLiBRdeG6o24gbMO9IGLhu59pIGRkAgMPDxYCHwAFC1RyYW5nIENo4bunZGQCBQ8PFgIfAAUtVGhp4bq/dCBr4bq/IGLhu59pIGN0eSBQaOG6p24gbeG7gW0gQW5oIFF1w6JuZGQCBw8PFgIfAAUMxJDhuqd1IFRyYW5nZGQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgUFOmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkY3RsMDAkTWVzc2FnZUJveDEkaW1nQ2xvc2VCdXR0b24FMWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkY3RsMDAkTWVzc2FnZUJveDEkYnRuT2sFK2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkY3RsMDAkcmFkX1RodVRpZXQFK2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkY3RsMDAkcmFkX1RodVRpZXQFKmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkY3RsMDAkcmFkX01vbkhvY5iO7uYSN0oZRpIo0OOLxvI58+54';
        let viewstate1 = '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YWxpZ249J2NlbnRlcicgPjAxPC90ZD4NCjx0ZCB3aWR0aD0nMzVweCcgYWxpZ249J2NlbnRlcic+NDwvdGQ+PHRkIHdpZHRoPSc5MHB4JyBhbGlnbj0nY2VudGVyJz48L3RkPg0KPHRkIHdpZHRoPSczNnB4JyBhbGlnbj0nY2VudGVyJz40PC90ZD48dGQgd2lkdGg9JzM1cHgnIGFsaWduPSdjZW50ZXInPiA8L3RkPjx0ZCB3aWR0aD0nMzVweCcgYWxpZ249J2NlbnRlcic+DQo8ZGl2IHN0eWxlPSdoZWlnaHQ6MjJweDt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7cGFkZGluZy10b3A6NXB4O3dpZHRoOjIycHgnPjwvZGl2PjwvdGQ+PHRkIHdpZHRoPSc0MHB4JyBhbGlnbj0nY2VudGVyJz48ZGl2IHN0eWxlPSdoZWlnaHQ6MjJweDt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7cGFkZGluZy10b3A6NXB4Jz48L2Rpdj48L3RkPjx0ZCB3aWR0aD0nNDBweCcgYWxpZ249J2NlbnRlcic+PGRpdiBzdHlsZT0naGVpZ2h0OjIycHg7dmVydGljYWwtYWxpZ246bWlkZGxlO3BhZGRpbmctdG9wOjVweCc+PC9kaXY+PC90ZD48dGQgd2lkdGg9JzQwcHgnIGFsaWduPSdjZW50ZXInPjxkaXYgc3R5bGU9J2hlaWdodDoyMnB4O3ZlcnRpY2FsLWFsaWduOm1pZGRsZTtwYWRkaW5nLXRvcDo1cHgnPjwvZGl2PjwvdGQ+PHRkIHdpZHRoPSc4MHB4JyBhbGlnbj0nY2VudGVyJz48ZGl2IHN0eWxlPSdoZWlnaHQ6MjJweDt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7cGFkZGluZy10b3A6NXB4Jz48L2Rpdj48L3RkPjx0ZCB3aWR0aD0nNTZweCcgYWxpZ249J2NlbnRlcic+PGRpdiBzdHlsZT0naGVpZ2h0OjIycHg7dmVydGljYWwtYWxpZ246bWlkZGxlO3BhZGRpbmctdG9wOjVweCc+PC9kaXY+PC90ZD48dGQgYWxpZ249J2xlZnQnIHN0eWxlPSdmb250LWZhbWlseTpjb3VyaWVyO2ZvbnQtc2l6ZTo4cHQnPjxkaXYgc3R5bGU9J2hlaWdodDoyMnB4O3ZlcnRpY2FsLWFsaWduOm1pZGRsZTtwYWRkaW5nLXRvcDo1cHg7Zm9udC1zaXplOjEwcHggICcgb25tb3VzZW92ZXI9ZGRyaXZldGlwdHVhbignJykgb25tb3VzZW91dD1oaWRlZGRyaXZldGlwKCk+PC9kaXY+PC90ZD48dGQgd2lkdGg9JzQwcHgnIGFsaWduPSdsZWZ0JyA+PC90ZD48L3RyPjwvdGFibGU+ZAISDxYCHwAF0AJHaGkgY2jDujogxJBLOiDEkcSDbmcga8O9OyBNw6MgTUg6IG3DoyBtw7RuIGjhu41jOyBOTUg6IE5ow7NtIG3DtG4gaOG7jWM7IFRUSDogVOG7lSB0aOG7sWMgaMOgbmg7IFNUQzogU+G7kSB0w61uIGNo4buJOyBTVENIUDogU+G7kSB0w61uIGNo4buJIGjhu41jIHBow607IENMOiBDw7JuIGzhuqFpOyBUSDogVGjhu7FjIGjDoG5oLCBLREs6IEtow7RuZyBjaG8gcGjDqXAgxJHEg25nIGvDvTtUaeG6v3QgQkQ6IFRp4bq/dCBi4bqvdCDEkeG6p3U7IFNUIDogU+G7kSBUaeG6v3Q7IENCR0Q6IE3DoyBjw6FuIGLhu5kgZ2nhuqNuZyBk4bqheTsgRFNTVjogRGFuaCBzw6FjaCBzaW5oIHZpw6puOyBkAhQPDxYCHwNoZBYOAgEPZBYCZg9kFg4CAQ9kFgJmDw8WAh8ABQlUSOG7qCBIQUlkZAICD2QWAmYPDxYCHwAFCFRI4buoIEJBZGQCAw9kFgJmDw8WAh8ABQlUSOG7qCBUxq9kZAIED2QWAmYPDxYCHwAFClRI4buoIE7Egk1kZAIFD2QWAmYPDxYCHwAFClRI4buoIFPDgVVkZAIGD2QWAmYPDxYCHwAFC1RI4buoIELhuqJZZGQCBw9kFgJmDw8WAh8ABQxDSOG7piBOSOG6rFRkZAIDDw8WAh8ABSlNw7RuIGjhu41jIGNo4buJIHRyw7luZyBt4buZdCB2w6BpIHRp4bq/dGRkAgUPDxYCHwAFDVR14bqnbiDEkOG6p3VkZAIHDw8WAh8ABQ9UdeG6p24gVHLGsOG7m2NkZAIJDw8WAh8ABQtUdeG6p24gS+G6v2RkAgsPDxYCHwAFDVR14bqnbiBDdeG7kWlkZAINDw8WAh8ABTYNCiAgICAgIE3DtG4gaOG7jWMgdHLDuW5nIHThuqV0IGPhuqMgY8OhYyB0aeG6v3QNCiAgICBkZAIJD2QWCAIBDw8WAh8ABTlDb3B5cmlnaHQgwqkyMDA5IEPGoSBT4bufIE1p4buBbiBC4bqvYy4gUXXhuqNuIGzDvSBi4bufaSBkZAIDDw8WAh8ABQtUcmFuZyBDaOG7p2RkAgUPDxYCHwAFLVRoaeG6v3Qga+G6vyBi4bufaSBjdHkgUGjhuqduIG3hu4FtIEFuaCBRdcOibmRkAgcPDxYCHwAFDMSQ4bqndSBUcmFuZ2RkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYFBTpjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGN0bDAwJE1lc3NhZ2VCb3gxJGltZ0Nsb3NlQnV0dG9uBTFjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGN0bDAwJE1lc3NhZ2VCb3gxJGJ0bk9rBStjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGN0bDAwJHJhZF9UaHVUaWV0BSpjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJGN0bDAwJHJhZF9Nb25Ib2MFKmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkY3RsMDAkcmFkX01vbkhvY0fnvfPf4GU8nvuXPVdxMyyXTZBF';
        let viewstate2 = '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';
        let monhoc0 = 'rad_MonHoc';
        let monhoc1 = '';
        let monhoc2 = '';
        let viewstate;
        let monhoc;
        if (i === 0){
            viewstate = viewstate0;
            monhoc = monhoc0;
        }
        else if (i === 1){
            viewstate = viewstate1;
            monhoc = monhoc1;
        }
        else{
            viewstate = viewstate2;
            monhoc = monhoc2;
        }
        let rq = request.post({
            url : 'http://qldt.ptit.edu.vn/default.aspx?page=thoikhoabieu&sta=1&id='+msv,     
            form : {
                __EVENTTARGET: 'ctl00$ContentPlaceHolder1$ctl00$ddlChonNHHK',
                __EVENTARGUMENT: '',
                __LASTFOCUS: '',
                __VIEWSTATE: viewstate,
                __VIEWSTATEGENERATOR: 'CA0B0334',
                ctl00$ContentPlaceHolder1$ctl00$ddlChonNHHK: ky,
                ctl00$ContentPlaceHolder1$ctl00$ddlLoai: '1',
                ctl00$ContentPlaceHolder1$ctl00$rad_MonHoc: monhoc,
                ctl00$ContentPlaceHolder1$ctl00$rad_ThuTiet: 'rad_ThuTiet'
            },
            followAllRedirects : true,
            jar : jar
        }, async (err, res, body) =>{
            if (err){
                console.log('loi thu hai');
                reject(err);
                return;
            }
            let $ = cheerio.load(body);
            var bod = $('.grid-roll2 .body-table tr td')
            var startDate = $('#ctl00_ContentPlaceHolder1_ctl00_lblNote').text().slice(-11,-1);
            var temp =[];
            $(bod).each(function(i, span){
                temp.push($(this).text().replace('\n','').trim())
            })

            let jsonObject1 = {}
            jsonObject1.ky = ky;
            jsonObject1.start = startDate;
            let monArr = [];
            for(var i = 0, j = 0; i< temp.length;i = i+15, j++){
                let jsonObject = {};
                jsonObject.MaMH = temp[i]
                jsonObject.TenMH = temp[i+1]
                jsonObject.NMH = temp[i+2]
                jsonObject.Thu = temp[i+8]
                jsonObject.TietBD = temp[i+9]
                jsonObject.ST = temp[i+10]
                jsonObject.Phong = temp[i+11]
                jsonObject.Tuan = temp[i+13]
                monArr.push(jsonObject);
            }
            jsonObject1.mon = monArr;
            jsonArr.push(jsonObject1);
            resolve(ky+'done');

        });
    });
}

}